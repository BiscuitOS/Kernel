Interrupt 11 -- Segment Not Present (#NP)
----------------------------------------------------

### Description

  Indicates that the present flag of a semgnet or gate descriptor is clear.
  The processor can generated this exception during any of the following
  operations:

  * While attempting to load CS, DS, ES, FS, or GS registers. [Detection of
    a not-present segment while loading the SS register causes a task fault
    exception (#SS) to be generated.] This situation can occur while 
    performing a task switch.

  * While attempting to load the LDTR using an LDT instruction. Detection
    of a not-present LDT while loading the LDTR during a task switch
    operation causes an invalid-TSS exception (#TS) to be generated.

  * When executing the LTR instruction and the TSS is marked not present.

  * While attempting to use a gate descriptor or TSS that is marked
    segment-not-present, but is otherwise valid.

  An operating system typically uses tht segment-not-present exception to
  implement virtual memory at the segment level. If the exception handler
  loads the segment and returns, the interrupted program or task resumes
  exception.

  A not-present indication in a gate descriptor, however, does not indicate
  that a segment is not present (because gates do not correspond to 
  segments). The operating system may use the present flag for gate
  descriptors to trigger exceptions of specical significance to the 
  operating system.

  A contributory exception or page fault that subsequently referenced a
  not-present segment would cause a double fault (#DF) to be generated
  instead of #NP.

### Exception Error Code

  An error code containing the segment selector index for the segment 
  descriptor that caused the violation is pushed onto the stack of the 
  exception handler. If the EXT flag is set, it indicates that the exception
  resulted from either:

  * an external event (NMI or INTR) that caused an interrupt, which 
    subsequently referenced a not-present segment.

  * a bengin exception that subsequently referenced a not-present segment.

  The IDT flag is set if the error code refers to an IDT entry. This occurs
  when the IDT entry for an interrupt being serviced references a not-present
  gate. Such an event could be generated by an INT instruction or hardware
  interrupt.

### Saved Instruction Pointer

  The saved contents of CS and EIP registers normally point to the instruction
  that generated the exception. If the exception occurred while loading
  segment descriptors for the segment selectors in a new TSS, the CS and EIP
  register point to the first instruction in the new task. If the exception
  occurred while accessing a gate descriptor, the CS and EIP registers point
  to the instruction that invoked the access (for example a CALL instrcution
  that reference a call gate).

### Program State Change

  If the segment-not-present exception occurs as the result of loading a 
  register (CS, DS, SS, ES, FS, GS or LDTR), a program-state change does
  accompany the exception because the register is not loaded. Recovery
  from this exception is possible by simply loading the missing segment
  into memory and setting the present flag in the segment descriptor.

  If the segment-not-present exception occurs while accessing a gate 
  descriptor, a program-state change does not accompany the exception. 
  Recovery from this exception is possible merely by setting the present
  flag in the gate descriptor.

  If a segment-not-present exception occurs during a task switch, it can
  occur before or after the commit-to-new-task-point. If tit occurs before
  the commit point, no program state change occurs. If it occurs after
  the commit point, the processor will load all the state information from
  the new TSS (without performing any additional limit, present, or type
  checks) before it generates the exception. The segment-not-present exception
  handler should not rely on being able to use the segment selecetor found
  in the CS, SS, DS, ES, FS and GS registers without causing another exception
  
### File list

  * interrupt10.c

    Common entry for triggering interrupt 10 (#TS) to be invoked by top
    interface.
 
  * soft-interrupt.c

    Describe how to trigger interrupt 10 (#TS) through soft-interrupt routine.

  * README.md

    Describe the basic information for interrupt 10 (#TS).

### Usage on BiscuitOS

  The kernel of BiscuitOS supports debug Interrupt10 online. Developer utilize
  `qemu` and `Kbuild` to debug #TS that contains specific triggered condition.
  please follow these action:

  1. Specify triggered condition with `Kbuild`.

     On top of kernel source tree, utilize `make menuconfig` to configure
     specific triggered condition for #TS. as follow:

     ```
       cd */BiscuitOS/kernel
       make menuconfig
     ```

     Then, developer will obtain figure as follow, please choose `Kernel 
     hacking`.

     ![Alt text](https://github.com/EmulateSpace/PictureSet/blob/master/BiscuitOS/BiscuitOS_common_Kbuild.png)

     The next figure, set `Debug/Running kernel` as `Y` and select `TestCase
     configuration`

     ![Alt text](https://github.com/EmulateSpace/PictureSet/blob/master/BiscuitOS/kernel_hacking/kernel_hacking.png)

     Now, set `Testcase for kernel function` as `Y` and select `Interrupt 
     Machanism on X86 Arichitecture`

     ![Alt text](https://github.com/EmulateSpace/PictureSet/blob/master/BiscuitOS/kernel_hacking/testcase/TestCase.png)

     Then, set `Debug Interrupt Machanism on X86 Architecture` and go on
     selecting `Interrupt 10 - Invalid TSS Exception (#TS)`.

     ![Alt text](https://github.com/EmulateSpace/PictureSet/blob/master/BiscuitOS/kernel_hacking/testcase/interrupt/INT_INT5_TOP.png)

     Finally, set `Interrupt 10 - Invalid TSS Exception (#TS)` as `Y`
     and choose a specific triggered condition to trigger #TS.

     ![Alt text](https://github.com/EmulateSpace/PictureSet/blob/master/BiscuitOS/kernel_hacking/testcase/interrupt/INT_INT5_MENU.png)

  2. Running and Debugging #TS

     The system default enable running BiscuitOS on `qemu`, so develper can
     running and debugging #9 as follow:

     ```
       cd */BiscuitOS/kernel
       make
       make start
     ```

     The Running-Figure as follow:

     ![Alt text](https://github.com/EmulateSpace/PictureSet/blob/master/BiscuitOS/kernel_hacking/testcase/interrupt/INT_INT5_RUN.png)

  3. Demo Code

     Developer can refer and review demo code on kernel procedure to debug or 
     prevent #TS. The demo code will indicate the triggered condition for #TS
     on kernel, so developer should review demo code details and prevent 
     #TS on your procedure. For example:

     ```
       /*
        * Trigger interrupt 10: invoke 'int $0xA'
        *   Note! whatever interrupt is enable or disable, this routine
        *   will trigger interrupt 10.
        */
       void trigger_interrupt10(void)
       {
           printk("Trigger interrupt 10: invalid TSS segment "
                               "[invoke 'int $0xA']\n");
           __asm__ ("int $0xA");
       }
     ```
